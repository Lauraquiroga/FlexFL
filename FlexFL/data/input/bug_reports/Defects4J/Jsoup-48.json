{
    "title": "A small bug for duplicate tuple in response header",
    "description": "\nfor response headers have duplicate tuple\uff0c\nin this case\nX-Powered-By:PHP/5.2.8\nX-Powered-By:ASP.NET\nJsoup can only get the second one\nif I run header\uff08\u201cX-powered-by\u201d\uff09\nI got Asp.NET\nURL\uff1ahttp://01pt.com/\nCache-Control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nContent-Encoding:gzip\nContent-Length:16224\nContent-Type:text/html;charset=gb2312\nDate:Thu, 27 Aug 2015 09:22:40 GMT\nExpires:Thu, 19 Nov 1981 08:52:00 GMT\nPragma:no-cache\nServer:Microsoft-IIS/7.5\nVary:Accept-Encoding\nX-Powered-By:PHP/5.2.8\nX-Powered-By:ASP.NET\nThe bug is because\nif (!values.isEmpty()) header(name, values.get(0));\nI change it to\nif (!values.isEmpty()) {\nString val = \"\";\nfor(String str: values) {\nval = val.concat(str).concat(\" \");\n                    }\n                    header(name, val);\n              }\n\nthen I am able to get \u201cPHP/5.2.8 ASP.NET\u201d when I run header\uff08\u201cX-powered-by\u201d\uff09\nvoid processResponseHeaders(Map<String, List> resHeaders) {\nfor (Map.Entry<String, List> entry : resHeaders.entrySet()) {\nString name = entry.getKey();\nif (name == null)\ncontinue; // http/1.1 line\n            List<String> values = entry.getValue();\n            if (name.equalsIgnoreCase(\"Set-Cookie\")) {\n                for (String value : values) {\n                    if (value == null)\n                        continue;\n                    TokenQueue cd = new TokenQueue(value);\n                    String cookieName = cd.chompTo(\"=\").trim();\n                    String cookieVal = cd.consumeTo(\";\").trim();\n                    // ignores path, date, domain, validateTLSCertificates et al. req'd?\n                    // name not blank, value not null\n                    if (cookieName.length() > 0)\n                        cookie(cookieName, cookieVal);\n                }\n            } else { // only take the first instance of each header\n                if (!values.isEmpty())\n                    header(name, values.get(0));\n            }\n        }\n    }\n\n"
}